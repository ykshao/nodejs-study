define(function(e,t,i){function n(){l.times+=1,l.roll();var e=$("#lottery").attr("prize_site"),t=$("#lottery").attr("prize_name");if(l.times>l.cycle+10&&l.index==e)setTimeout(function(){var e=$('<li class="chick"><span>'+$("#lottery").attr("nick_name")+"</span><b>\u62bd\u4e2d"+t+"</b></li>");$(".names li").eq(3).after(e),$(".dialog").addClass("hide"),$("#dialog").removeClass("hide"),$("#dialog .box img").eq($("#lottery").attr("prize_id")).show(),$("#dialog").find(".prizeName").html(t)},500),clearTimeout(l.timer),l.prize=-1,l.times=0,o=!1;else{if(l.times<l.cycle)l.speed-=10;else if(l.times==l.cycle){var i=Math.random()*l.count|0;l.prize=i}else l.times>l.cycle+10&&(0==l.prize&&7==l.index||l.prize==l.index+1)?l.speed+=110:l.speed+=50;l.speed<40&&(l.speed=40),l.timer=setTimeout(n,l.speed)}return!1}function s(){var e=$(".share_names");e.find(".name_list").animate({marginTop:"-0.6875rem"},500,"ease-in-out",function(){$(this).css({marginTop:"0rem"}).find("li:first").appendTo(this)})}function a(e){var e=e,t=$("#send_code"),i=setInterval(function(){e--,t.text(e+"s"),0>e&&(t.text("\u91cd\u83b7\u9a8c\u8bc1\u7801"),t.removeClass("sending"),clearInterval(i))},1e3)}var r={isEmpty:function(e){return e?!0:!1},isMobile:function(e){var t=/^1[0-9]{10}$/;return t.test(e)?!0:!1},isPassword:function(e){var t=/^[A-Za-z0-9\!\@\#\$\%\^\&\*\(\)]{6,20}$/;return t.test(e)?!0:!1}},l={index:0,count:0,timer:0,speed:20,times:0,cycle:40,prize:0,init:function(e){$("#"+e).find(".l_prize").length>0&&($lottery=$("#"+e),$units=$lottery.find(".l_prize"),this.obj=$lottery,this.count=$units.length,$lottery.find(".l_prize-"+this.index).addClass("l_now"))},roll:function(){var e=this.index,t=this.count,i=this.obj;return $(i).find(".l_prize-"+e).removeClass("l_now"),e+=1,e>t-1&&(e=0),$(i).find(".l_prize-"+e).addClass("l_now"),this.index=e,!1},stop:function(e){return this.prize=e,!1}},o=!1;$(function(){l.init("lottery"),$("#lottery .pointer").click(function(){var e=$(this);return"1"==e.attr("send")?!1:(console.log(e.attr("send")),l.speed=100,$.ajax({type:"post",dataType:"json",url:"/Landing/dofestival",data:{},beforeSend:function(){e.attr("send","1")},success:function(t){1==t.status?($("#lottery").attr("prize_site",t.data.angle-1),$("#lottery").attr("prize_id",t.data.id-1),$("#lottery").attr("nick_name",t.data.nick_name),$("#lottery").attr("prize_name",t.data.prize),n()):($(".dialog").addClass("hide"),alert(t.info)),e.removeAttr("send")}}),o=!0,!1)})}),setInterval(s,2e3),$("#dialog .close").click(function(){$("#dialog").addClass("hide").find("img").hide()}),$("#j_tip .close").click(function(){$("#j_tip").addClass("hide")}),$("#send_code").tap(function(){var e=$("#reg1_tel").val();if(!$(this).hasClass("sending"))return r.isEmpty(e)?r.isMobile(e)?void $.ajax({url:"/Ajax/sendSms",type:"POST",datatype:"json",data:{mobile:e},success:function(e){var e=JSON.parse(e);0==e.status?alert(e.info):1==e.status&&($("#send_code").addClass("sending"),a(60))}}):(alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7"),!1):(alert("\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7\u7801"),!1)});var d=$("#regBtn"),c=$("#regForm");d.on("click",function(){var e=$("#reg1_tel").val(),t=$("#reg1_passwd").val(),i=$("#reg1_code").val();$("#register_from").val();return r.isEmpty(e)?r.isMobile(e)?i?r.isEmpty(t)?r.isPassword(t)?void c.submit():(alert("\u5bc6\u7801\u957f\u5ea6\u4e3a6~20"),!1):(alert("\u8bf7\u8bbe\u7f6e\u60a8\u7684\u5bc6\u7801"),!1):void alert("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"):(alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7"),!1):(alert("\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7\u7801"),!1)})});